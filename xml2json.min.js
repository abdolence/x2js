!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.X2JS=e()}(this,function(){return function(t){"use strict";function e(){void 0===t.escapeMode&&(t.escapeMode=!0),t.attributePrefix=t.attributePrefix||"_",t.arrayAccessForm=t.arrayAccessForm||"none",t.emptyNodeForm=t.emptyNodeForm||"text",void 0===t.enableToStringFunc&&(t.enableToStringFunc=!0),t.arrayAccessFormPaths=t.arrayAccessFormPaths||[],void 0===t.skipEmptyTextNodesForObj&&(t.skipEmptyTextNodesForObj=!0),void 0===t.stripWhitespaces&&(t.stripWhitespaces=!0),t.datetimeAccessFormPaths=t.datetimeAccessFormPaths||[],void 0===t.useDoubleQuotes&&(t.useDoubleQuotes=!1)}function n(){function t(t){var e=String(t);return 1===e.length&&(e="0"+e),e}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}function r(t){var e=t.localName;return null==e&&(e=t.baseName),(null==e||""==e)&&(e=t.nodeName),e}function i(t){return t.prefix}function s(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):t}function a(e,n,r){switch(t.arrayAccessForm){case"property":e[n+"_asArray"]=e[n]instanceof Array?e[n]:[e[n]]}if(!(e[n]instanceof Array)&&t.arrayAccessFormPaths.length>0){for(var i=0;i<t.arrayAccessFormPaths.length;i++){var s=t.arrayAccessFormPaths[i];if("string"==typeof s){if(s==r)break}else if(s instanceof RegExp){if(s.test(r))break}else if("function"==typeof s&&s(e,n,r))break}i!=t.arrayAccessFormPaths.length&&(e[n]=[e[n]])}}function o(t){var e=t.split(/[-T:+Z]/g),n=new Date(e[0],e[1]-1,e[2]),r=e[5].split(".");if(n.setHours(e[3],e[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),e[6]&&e[7]){var i=60*e[6]+Number(e[7]),s=/\d\d-\d\d:\d\d$/.test(t)?"-":"+";i=0+("-"==s?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function c(e,n,r){if(t.datetimeAccessFormPaths.length>0){for(var i=r.split(".#")[0],s=0;s<t.datetimeAccessFormPaths.length;s++){var a=t.datetimeAccessFormPaths[s];if("string"==typeof a){if(a==i)break}else if(a instanceof RegExp){if(a.test(i))break}else if("function"==typeof a&&a(obj,n,i))break}return s!=t.datetimeAccessFormPaths.length?o(e):e}return e}function l(e,n){if(e.nodeType==O.DOCUMENT_NODE){for(var s=new Object,o=e.childNodes,u=0;u<o.length;u++){var f=o.item(u);if(f.nodeType==O.ELEMENT_NODE){var _=r(f);s[_]=l(f,_)}}return s}if(e.nodeType==O.ELEMENT_NODE){var s=new Object;s.__cnt=0;for(var o=e.childNodes,u=0;u<o.length;u++){var f=o.item(u),_=r(f);f.nodeType!=O.COMMENT_NODE&&(s.__cnt++,null==s[_]?(s[_]=l(f,n+"."+_),a(s,_,n+"."+_)):(null!=s[_]&&(s[_]instanceof Array||(s[_]=[s[_]],a(s,_,n+"."+_))),s[_][s[_].length]=l(f,n+"."+_)))}for(var d=0;d<e.attributes.length;d++){var p=e.attributes.item(d);s.__cnt++,s[t.attributePrefix+p.name]=p.value}var g=i(e);return null!=g&&""!=g&&(s.__cnt++,s.__prefix=g),null!=s["#text"]&&(s.__text=s["#text"],s.__text instanceof Array&&(s.__text=s.__text.join("\n")),t.stripWhitespaces&&(s.__text=s.__text.trim()),delete s["#text"],"property"==t.arrayAccessForm&&delete s["#text_asArray"],s.__text=c(s.__text,_,n+"."+_)),null!=s["#cdata-section"]&&(s.__cdata=s["#cdata-section"],delete s["#cdata-section"],"property"==t.arrayAccessForm&&delete s["#cdata-section_asArray"]),1==s.__cnt&&null!=s.__text?s=s.__text:0==s.__cnt&&"text"==t.emptyNodeForm?s="":s.__cnt>1&&null!=s.__text&&t.skipEmptyTextNodesForObj&&(t.stripWhitespaces&&""==s.__text||""==s.__text.trim())&&delete s.__text,delete s.__cnt,!t.enableToStringFunc||null==s.__text&&null==s.__cdata||(s.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),s}return e.nodeType==O.TEXT_NODE||e.nodeType==O.CDATA_SECTION_NODE?e.nodeValue:void 0}function u(e,n,r,i){var a="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+n;if(null!=r)for(var o=0;o<r.length;o++){var c=r[o],l=e[c];t.escapeMode&&(l=s(l)),a+=" "+c.substr(t.attributePrefix.length)+"=",a+=t.useDoubleQuotes?'"'+l+'"':"'"+l+"'"}return a+=i?"/>":">"}function f(t,e){return"</"+(null!=t.__prefix?t.__prefix+":":"")+e+">"}function _(t,e){return-1!==t.indexOf(e,t.length-e.length)}function d(e,n){return"property"==t.arrayAccessForm&&_(n.toString(),"_asArray")||0==n.toString().indexOf(t.attributePrefix)||0==n.toString().indexOf("__")||e[n]instanceof Function?!0:!1}function p(t){var e=0;if(t instanceof Object)for(var n in t)d(t,n)||e++;return e}function g(e){var n=[];if(e instanceof Object)for(var r in e)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(t.attributePrefix)&&n.push(r);return n}function h(e){var n="";return null!=e.__cdata&&(n+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(n+=t.escapeMode?s(e.__text):e.__text),n}function m(e){var n="";return e instanceof Object?n+=h(e):null!=e&&(n+=t.escapeMode?s(e):e),n}function x(t,e,n){var r="";if(0==t.length)r+=u(t,e,n,!0);else for(var i=0;i<t.length;i++)r+=u(t[i],e,g(t[i]),!1),r+=y(t[i]),r+=f(t[i],e);return r}function y(t){var e="",n=p(t);if(n>0)for(var r in t)if(!d(t,r)){var i=t[r],s=g(i);if(null==i||void 0==i)e+=u(i,r,s,!0);else if(i instanceof Object)if(i instanceof Array)e+=x(i,r,s);else if(i instanceof Date)e+=u(i,r,s,!1),e+=i.toISOString(),e+=f(i,r);else{var a=p(i);a>0||null!=i.__text||null!=i.__cdata?(e+=u(i,r,s,!1),e+=y(i),e+=f(i,r)):e+=u(i,r,s,!0)}else e+=u(i,r,s,!1),e+=m(i),e+=f(i,r)}return e+=m(t)}var v="1.1.8";t=t||{},e(),n();var O={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(t){var e=window.ActiveXObject||"ActiveXObject"in window;if(void 0===t)return null;var n;if(window.DOMParser){var r=new window.DOMParser,i=null;if(!e)try{i=r.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(s){i=null}try{n=r.parseFromString(t,"text/xml"),null!=i&&n.getElementsByTagNameNS(i,"parsererror").length>0&&(n=null)}catch(s){n=null}}else 0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t);return n},this.asArray=function(t){return void 0===t||null==t?[]:t instanceof Array?t:[t]},this.toXmlDateTime=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.asDateTime=function(t){return"string"==typeof t?o(t):t},this.xml2json=function(t){return l(t)},this.xml_str2json=function(t){var e=this.parseXmlString(t);return null!=e?this.xml2json(e):null},this.json2xml_str=function(t){return y(t)},this.json2xml=function(t){var e=this.json2xml_str(t);return this.parseXmlString(e)},this.getVersion=function(){return v}}});